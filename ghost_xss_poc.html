<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GhostRecon v8 â€“ DOM Sink Deep Analyzer</title>
</head>
<body>
  <h2>ðŸ§ª GhostRecon v8 â€“ DOM Sink Deep Analyzer</h2>
  <script>
    (async () => {
      console.log("ðŸ” GhostRecon v8 â€“ DOM Sink Deep Analyzer Started...");

      const reflectedParams = new URLSearchParams(location.search);
      const tl = reflectedParams.get("tl");
      const sl = reflectedParams.get("sl");
      const op = reflectedParams.get("op");

      const targets = [tl, sl, op].filter(Boolean);
      const dangerousSinks = ["innerHTML", "outerHTML", "insertAdjacentHTML", "eval", "setTimeout", "Function"];
      const results = [];

      // ðŸ”Ž 1. ÙØ­Øµ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…Ù†Ø¹ÙƒØ³Ø© Ø¯Ø§Ø®Ù„ Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø©
      targets.forEach((param) => {
        const nodes = document.querySelectorAll("*");
        nodes.forEach((node) => {
          dangerousSinks.forEach((sink) => {
            try {
              const value = node[sink];
              if (typeof value === "string" && value.includes(param)) {
                results.push({
                  param,
                  sink,
                  tag: node.tagName,
                  snippet: value.substring(0, 100)
                });
              }
            } catch (_) {}
          });
        });
      });

      // ðŸ”Ž 2. ÙØ­Øµ Ø¯Ø§Ø®Ù„ window.WIZ_global_data
      const wiz = window.WIZ_global_data || {};
      Object.entries(wiz).forEach(([key, value]) => {
        targets.forEach((param) => {
          if (typeof value === "string" && value.includes(param)) {
            results.push({
              param,
              sink: "WIZ_global_data",
              key,
              snippet: value.substring(0, 100)
            });
          }
        });
      });

      // â±ï¸ 3. Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø§Ù„Ø¢Ù…Ù†
      try {
        if (tl && /alert|console|XSS/i.test(tl)) {
          setTimeout(() => {
            new Function(decodeURIComponent(tl))();
            console.log("âœ… XSS Payload Executed from tl param");
          }, 500);
        }
      } catch (_) {
        console.warn("âŒ Execution failed.");
      }

      // ðŸ“‹ 4. Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
      if (results.length > 0) {
        console.table(results);
      } else {
        console.log("âŒ No dangerous sinks found.");
      }

      // ðŸ§¾ ØªÙˆÙ‚ÙŠØ¹ ÙˆÙˆÙ‚Øª
      const hash = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(JSON.stringify(results)));
      const hex = Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
      console.log("ðŸ§¾ Report Hash:", hex);

    })();
  </script>
</body>
</html>

